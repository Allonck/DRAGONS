<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2. Class Reduce: Settable properties and attributes &mdash; Reduce Users Manual X1.0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/todo-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'X1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Reduce Users Manual X1.0.1 documentation" href="../index.html" />
    <link rel="prev" title="1. reduce demo" href="appendix_demo.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="appendix_demo.html" title="1. reduce demo"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Reduce Users Manual X1.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="class-reduce-settable-properties-and-attributes">
<span id="props"></span><h1>2. Class Reduce: Settable properties and attributes<a class="headerlink" href="#class-reduce-settable-properties-and-attributes" title="Permalink to this headline">¶</a></h1>
<p>The public interface on an instance of the Reduce() class provides a
number of properties and attributes that allow the user to set and reset
options as they might through the reduce command line interface. The following
table is an enumerated set of those attributes.</p>
<p>An instance of Reduce() provides the following attributes. (Note: defaults
are not necessarily indicative of the actual type that is expected on
the instance. Use the type specified in the type column.):</p>
<div class="highlight-python"><div class="highlight"><pre>Attribute                  Python type         Default
------------------------------------------------------
astrotype                  &lt;type &#39;str&#39;&gt;         None
cal_mgr                    &lt;type &#39;str&#39;&gt;         None
displayflags               &lt;type &#39;bool&#39;&gt;        False
files                      &lt;type &#39;list&#39;&gt;        []
invoked                    &lt;type &#39;bool&#39;&gt;        False
logfile                    &lt;type &#39;str&#39;&gt;         &#39;reduce.log&#39;
loglevel                   &lt;type &#39;str&#39;&gt;         &#39;stdinfo&#39;
logmode                    &lt;type &#39;str&#39;&gt;         &#39;standard&#39;
primsetname                &lt;type &#39;str&#39;&gt;         None
recipename                 &lt;type &#39;str&#39;&gt;         None
running_contexts           &lt;type &#39;str&#39;&gt;         None
suffix                     &lt;type &#39;str&#39;&gt;         None
throwDescriptorExceptions  &lt;type &#39;bool&#39;&gt;        False
user_cals                  &lt;type &#39;str&#39;&gt;         None
userparam                  &lt;type &#39;list&#39;&gt;        None
</pre></div>
</div>
<div class="section" id="examples">
<h2>2.1. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Setting attributes on a Reduce object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">reduce</span> <span class="o">=</span> <span class="n">Reduce</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">reduce</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="s">&quot;my_reduction.log&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">reduce</span><span class="o">.</span><span class="n">recipe</span> <span class="o">=</span> <span class="s">&quot;recipe.my_recipe&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">reduce</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;UVW.fits&#39;</span><span class="p">,</span> <span class="s">&#39;XYZ.fits&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Or in other pythonic ways:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">file_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;FOO.fits&#39;</span><span class="p">,</span> <span class="s">&#39;BAR.fits&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">reduce</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">reduce</span><span class="o">.</span><span class="n">files</span>
<span class="go">[&#39;UVW.fits&#39;, &#39;XYZ.fits&#39;, &#39;FOO.fits&#39;, &#39;BAR.fits&#39;]</span>
</pre></div>
</div>
<p>Users wishing to pass primtive parameters to the recipe_system need only set
the one (1) attribute, <tt class="docutils literal"><span class="pre">userparam</span></tt>, on the Reduce instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">reduce</span><span class="o">.</span><span class="n">userparam</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;clobber=True&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>This is the API equivalent to the command line option:</p>
<div class="highlight-python"><div class="highlight"><pre>$ reduce -p clobber=True [...]
</pre></div>
</div>
<p>For muliple primitive parameters, the &#8216;userparam&#8217; attribute is a list of
&#8216;par=val&#8217; strings, as in:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">reduce</span><span class="o">.</span><span class="n">userparam</span> <span class="o">=</span> <span class="p">[</span> <span class="s">&#39;par1=val1&#39;</span><span class="p">,</span> <span class="s">&#39;par2=val2&#39;</span><span class="p">,</span> <span class="o">...</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="example-function">
<h2>2.2. Example function<a class="headerlink" href="#example-function" title="Permalink to this headline">¶</a></h2>
<p>The following function shows a potential usage of class Reduce. When
conditions are met, the function <tt class="docutils literal"><span class="pre">reduce_conditions_met()</span></tt> is called
passing several lists of files, <tt class="docutils literal"><span class="pre">procfiles</span></tt> (a list of lists of fits
files). Here, each list of <tt class="docutils literal"><span class="pre">procfiles</span></tt> is then passed to the internal
<tt class="docutils literal"><span class="pre">launch_reduce()</span></tt> function.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">astrodata.utils</span> <span class="kn">import</span> <span class="n">logutils</span>
<span class="kn">from</span> <span class="nn">recipe_system.reduction.coreReduce</span> <span class="kn">import</span> <span class="n">Reduce</span>

<span class="k">def</span> <span class="nf">reduce_conditions_are_met</span><span class="p">(</span><span class="n">procfiles</span><span class="p">,</span> <span class="n">control_options</span><span class="o">=</span><span class="p">{}):</span>
    <span class="n">reduce_object</span> <span class="o">=</span> <span class="n">Reduce</span><span class="p">()</span>
    <span class="n">reduce_object</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="s">&#39;my_reduce.log&#39;</span>
    <span class="c"># write logfile only, no stdout.</span>
    <span class="n">reduce_object</span><span class="o">.</span><span class="n">logmode</span> <span class="o">=</span> <span class="s">&#39;quiet&#39;</span>
    <span class="n">reduce_object</span><span class="o">.</span><span class="n">userparam</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;clobber=True&#39;</span><span class="p">]</span>

    <span class="n">logutils</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">reduce_object</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="n">reduce_object</span><span class="o">.</span><span class="n">logmode</span><span class="p">,</span>
                    <span class="n">console_lvl</span><span class="o">=</span><span class="n">reduce_object</span><span class="o">.</span><span class="n">loglevel</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">launch_reduce</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">recipe</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">upload</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">reduce_object</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="n">datasets</span>
        <span class="k">if</span> <span class="n">recipe</span><span class="p">:</span>
            <span class="n">reduce_object</span><span class="o">.</span><span class="n">recipename</span> <span class="o">=</span> <span class="n">recipe</span>
        <span class="k">if</span> <span class="n">upload</span><span class="p">:</span>
            <span class="n">reduce_object</span><span class="o">.</span><span class="n">running_contexts</span> <span class="o">=</span> <span class="s">&#39;upload&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reduce_object</span><span class="o">.</span><span class="n">running_contexts</span> <span class="o">=</span> <span class="s">&#39;qa&#39;</span>
        <span class="n">reduce_object</span><span class="o">.</span><span class="n">runr</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">for</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">procfiles</span><span class="p">:</span>
        <span class="c"># Use a different recipe if FOO.fits is present</span>
        <span class="k">if</span> <span class="s">&quot;FOO.fits&quot;</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">launch_reduce</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="n">recipe</span><span class="o">=</span><span class="s">&quot;recipe.FOO&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">launch_reduce</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="n">upload</span><span class="o">=</span><span class="n">control_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;upload&#39;</span><span class="p">))</span>

    <span class="k">return</span>

<span class="n">procfiles</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s">&#39;FOO.fits&#39;</span><span class="p">,</span> <span class="s">&#39;BAR.fits&#39;</span><span class="p">],</span>
              <span class="p">[</span><span class="s">&#39;UVW.fits&#39;</span><span class="p">,</span> <span class="s">&#39;XYZ.fits&#39;</span><span class="p">]</span>
           <span class="p">]</span>
<span class="k">if</span> <span class="n">conditions_are_met</span><span class="p">:</span>
    <span class="n">reduce_conditions_are_met</span><span class="p">(</span><span class="n">procfiles</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Readers will see here that calling <tt class="docutils literal"><span class="pre">reduce_conditions_are_met()</span></tt> without the
<tt class="docutils literal"><span class="pre">control_options</span></tt> parameter will result in the <tt class="docutils literal"><span class="pre">running_contexts</span></tt> attribute
being set to <tt class="docutils literal"><span class="pre">'qa'</span></tt>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2. Class Reduce: Settable properties and attributes</a><ul>
<li><a class="reference internal" href="#examples">2.1. Examples</a></li>
<li><a class="reference internal" href="#example-function">2.2. Example function</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="appendix_demo.html"
                        title="previous chapter">1. <cite>reduce</cite> demo</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/appendices/reduce_properties.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="appendix_demo.html" title="1. reduce demo"
             >previous</a> |</li>
        <li><a href="../index.html">Reduce Users Manual X1.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Kenneth Anderson.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>