<html>
<head>
<title>Gemini JUI Cmd Pump</title>
<script src="/qap/jquery.js"></script>
<script src="/qap/js/cmdpump.js"></script>
<script language="javascript" type="text/javascript" src="/qap/js/jqplot/jquery.jqplot.min.js"></script>
<script type="text/javascript" src="/qap/js/jqplot/plugins/jqplot.canvasTextRenderer.min.js"></script>
<script type="text/javascript" src="/qap/js/jqplot/plugins/jqplot.canvasAxisLabelRenderer.min.js"></script></head>
<script type="text/javascript" src="/qap/js/jqplot/plugins/jqplot.dateAxisRenderer.min.js"></script>

<link rel="stylesheet" type="text/css" href="/qap/js/jqplot/jquery.jqplot.css" />
<body>

<h2>Command Pump Test Page</h2>
<div id="statout" style="width:400;height:200">
</div>
<div id="cmd_display">
</div>
<script type="text/javascript">
var data = [];
var plot1 = null;
var mindate = null;
var maxdate = null;

function mystatcallback(msg)
{
    if (msg["stat_name"] == "IQ") {return;}
    console.log("cmpdpump.html:17:"+ JSON.stringify(msg));
    data[data.length] = [msg["date"], msg["stat_float"]];
    //data[data.length] = [ msg["stat_float"],msg["date"]];
    console.log("data:"+JSON.stringify(data));
    if (mindate == null)
    {
        mindate = msg["date"]
    }
    maxdate = msg["date"];
    
    if (plot1)
    { 
        plot1.destroy()
    }
    if (true)
    {
        plot1 = $.jqplot("statout", [data],
                    { "title":"Zeropoint",
                      axes: { xaxis: {renderer:$.jqplot.DateAxisRenderer,
                                min:mindate,
                                max:maxdate}},
                     });
        
    }
    else
    {
        plot1.data = [data];
        plot1.replot({resetAxes:true,
        "title":"Zeropoint",
                      axes: { xaxis: {renderer:$.jqplot.DateAxisRenderer}},
                     });
    }
}
$("body").ready(function()
{
    register_stat_callback(mystatcallback);
    gempipe_cmdpump();
});

</script>
</body>
</html>
